<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>í™ˆ - TES Speaking</title>
    <link rel="stylesheet" href="../css/style.css">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;600;700&display=swap"
        rel="stylesheet">
    <style>
        body {
            font-family: 'Noto Sans KR', sans-serif;
        }
    </style>
    <link rel="icon" type="image/png" sizes="32x32" href="../favicon.png">
    <link rel="apple-touch-icon" href="../favicon.png">
</head>

<body>
    <div class="app-container">
        <div class="page-content">
            <!-- Welcome Section -->
            <div class="welcome-section">
                <p class="welcome-text">ì•ˆë…•í•˜ì„¸ìš” ğŸ‘‹</p>
                <h1 class="welcome-name" id="studentName">í•™ìƒ</h1>
            </div>

            <!-- Stats Card -->
            <div class="stats-card">
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <div>
                        <div class="stats-value" id="learnedCount">0</div>
                        <div class="stats-label">ì™„ë£Œí•œ í•™ìŠµ</div>
                    </div>
                    <div style="text-align: right;">
                        <div style="font-size: 0.875rem; opacity: 0.9;">ì˜¤ëŠ˜ì˜ ëª©í‘œ</div>
                        <div style="font-size: 1.25rem; font-weight: 600;"><span id="todayCompleted">0</span> / 5 ìœ ë‹›
                        </div>
                    </div>
                </div>
            </div>

            <!-- Quick Start -->
            <div class="quick-start-card" onclick="location.href='class.html'">
                <div class="quick-start-title">í•™ìŠµ ê³„ì†í•˜ê¸°</div>
                <div class="quick-start-desc" id="lastLearningDesc">ë§ˆì§€ë§‰ í•™ìŠµ: -</div>
                <button class="quick-start-btn">
                    ê³„ì†í•˜ê¸° â†’
                </button>
            </div>

            <!-- Menu Cards -->
            <h2 style="font-size: 1.125rem; font-weight: 600; margin: 24px 0 16px;">í•™ìŠµ ë©”ë‰´</h2>

            <a href="class.html" class="list-card">
                <div class="list-icon"><i class="ti ti-books"></i></div>
                <div class="list-content">
                    <div class="list-title">ë‚˜ì˜ í´ë˜ìŠ¤</div>
                    <div class="list-subtitle">êµê³¼ì„œ ë° ìœ ë‹› ì„ íƒ</div>
                </div>
                <span class="list-arrow"><i class="ti ti-chevron-right"></i></span>
            </a>

            <a href="stats.html" class="list-card">
                <div class="list-icon"><i class="ti ti-chart-bar"></i></div>
                <div class="list-content">
                    <div class="list-title">í•™ìŠµ í†µê³„</div>
                    <div class="list-subtitle">ë‚˜ì˜ ì„±ì·¨ë„ í™•ì¸</div>
                </div>
                <span class="list-arrow"><i class="ti ti-chevron-right"></i></span>
            </a>

            <a href="recordings.html" class="list-card">
                <div class="list-icon"><i class="ti ti-video"></i></div>
                <div class="list-content">
                    <div class="list-title">ë…¹í™” ì˜ìƒ</div>
                    <div class="list-subtitle">ì €ì¥ëœ ë…¹í™” ë³´ê¸°</div>
                </div>
                <span class="list-arrow"><i class="ti ti-chevron-right"></i></span>
            </a>
        </div>

        <!-- Bottom Navigation -->
        <nav class="bottom-nav">
            <a href="main.html" class="nav-item active">
                <span class="nav-icon"><i class="ti ti-home"></i></span>
                <span>í™ˆ</span>
            </a>
            <a href="class.html" class="nav-item">
                <span class="nav-icon"><i class="ti ti-books"></i></span>
                <span>í´ë˜ìŠ¤</span>
            </a>
            <a href="stats.html" class="nav-item">
                <span class="nav-icon"><i class="ti ti-chart-bar"></i></span>
                <span>í†µê³„</span>
            </a>
            <a href="profile.html" class="nav-item">
                <span class="nav-icon"><i class="ti ti-user"></i></span>
                <span>í”„ë¡œí•„</span>
            </a>
        </nav>
    </div>

    <script src="../js/supabase.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const student = JSON.parse(sessionStorage.getItem('currentStudent'));
            if (!student) {
                window.location.href = '../index.html';
                return;
            }
            document.getElementById('studentName').textContent = student.name + 'ë‹˜';

            // Load today's progress
            const today = new Date().toISOString().split('T')[0];
            const completionKey = `completion_${student.name}_${today}`;
            const todayData = JSON.parse(localStorage.getItem(completionKey) || 'null');

            const completed = todayData ? todayData.sessions : 0;
            document.getElementById('learnedCount').textContent = completed;
            document.getElementById('todayCompleted').textContent = completed;

            // Load last learning info
            loadLastLearning(student);
        });

        function loadLastLearning(student) {
            const lastLearning = JSON.parse(localStorage.getItem('lastLearning_' + student.name) || 'null');
            const descEl = document.getElementById('lastLearningDesc');

            if (lastLearning && lastLearning.unitTitle) {
                descEl.textContent = `ë§ˆì§€ë§‰ í•™ìŠµ: ${lastLearning.unitTitle}`;
            } else {
                descEl.textContent = 'ì•„ì§ í•™ìŠµ ê¸°ë¡ì´ ì—†ì–´ìš”';
            }
        }
    </script>
</body>

</html>